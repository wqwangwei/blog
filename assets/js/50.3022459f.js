(window.webpackJsonp=window.webpackJsonp||[]).push([[50],{547:function(a,s,t){"use strict";t.r(s);var e=t(12),r=Object(e.a)({},(function(){var a=this,s=a.$createElement,t=a._self._c||s;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("blockquote",[t("p",[a._v("引用自："),t("a",{attrs:{href:"https://blog.csdn.net/u012203437/article/details/49737365",target:"_blank",rel:"noopener noreferrer"}},[a._v("ECS Linux开启swap（虚拟内存）"),t("OutboundLink")],1)])]),a._v(" "),t("p",[a._v("阿里云在2018年春节前后通过一系列的促销活动向新老顾客推广云服务器，在诱人的价格面前笔者贡献了口袋里最后的可支配人民币，但实际使用下来，发现1核2G内存的ECS服务器的性能实在有限，特别是最近在上面部署docker容器的时候明显感觉到内存吃紧。思来想去，发现可以通过开启swap分区来解决内存瓶颈。")]),a._v(" "),t("h2",{attrs:{id:"swap分区大小设置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#swap分区大小设置"}},[a._v("#")]),a._v(" swap分区大小设置")]),a._v(" "),t("p",[a._v("阿里云的linux云服务器默认是没有启用swap分区（交换分区）的。一般情况下swapswap分区的大小可以参考以下规则进行设定：")]),a._v(" "),t("table",[t("thead",[t("tr",[t("th",[a._v("内存大小")]),a._v(" "),t("th",[a._v("swap大小")])])]),a._v(" "),t("tbody",[t("tr",[t("td",[a._v("MEM_SIZE <= 4G")]),a._v(" "),t("td",[a._v("最小2G")])]),a._v(" "),t("tr",[t("td",[a._v("4G < MEM_SIZE <= 16G")]),a._v(" "),t("td",[a._v("最小4G")])]),a._v(" "),t("tr",[t("td",[a._v("16G < MEM_SIZE <= 64G")]),a._v(" "),t("td",[a._v("最小8G")])]),a._v(" "),t("tr",[t("td",[a._v("64G < MEM_SIZE <= 256G")]),a._v(" "),t("td",[a._v("最小16G")])])])]),a._v(" "),t("h2",{attrs:{id:"启用swap分区"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#启用swap分区"}},[a._v("#")]),a._v(" 启用swap分区")]),a._v(" "),t("h3",{attrs:{id:"创建用于交换分区的文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建用于交换分区的文件"}},[a._v("#")]),a._v(" 创建用于交换分区的文件")]),a._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("dd")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("if")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/dev/zero "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("of")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/mnt/swap "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("bs")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("block_size "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("count")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("number_of_block\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("p",[a._v("其中"),t("code",[a._v("block_size")]),a._v("和"),t("code",[a._v("number_of_block")]),a._v("的大小可以自定义，例如"),t("code",[a._v("bs=1M count=2048")]),a._v("代表2G大小的swap分区。")]),a._v(" "),t("h3",{attrs:{id:"设置交换分区文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#设置交换分区文件"}},[a._v("#")]),a._v(" 设置交换分区文件")]),a._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("mkswap")]),a._v(" /mnt/swap\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("h3",{attrs:{id:"立即启用交换分区文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#立即启用交换分区文件"}},[a._v("#")]),a._v(" 立即启用交换分区文件")]),a._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("swapon")]),a._v(" /mnt/swap\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("h3",{attrs:{id:"设置开机自动启用swap分区"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#设置开机自动启用swap分区"}},[a._v("#")]),a._v(" 设置开机自动启用swap分区")]),a._v(" "),t("p",[a._v("在"),t("code",[a._v("/etc/fstab")]),a._v("中增加swap配置行。")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("/mnt/swap   swap    swap    defaults    0   0\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("h2",{attrs:{id:"查看效果"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查看效果"}},[a._v("#")]),a._v(" 查看效果")]),a._v(" "),t("p",[a._v("设置完成之后可以通过linux的"),t("code",[a._v("free -m")]),a._v("命令查看swap分区的状态。")])])}),[],!1,null,null,null);s.default=r.exports}}]);